(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01a30cf2"],{"0ead":function(e,t,o){},"159b":function(e,t,o){var l=o("da84"),r=o("fdbc"),i=o("17c2"),a=o("9112");for(var c in r){var s=l[c],n=s&&s.prototype;if(n&&n.forEach!==i)try{a(n,"forEach",i)}catch(d){n.forEach=i}}},"17c2":function(e,t,o){"use strict";var l=o("b727").forEach,r=o("a640"),i=r("forEach");e.exports=i?[].forEach:function(e){return l(this,e,arguments.length>1?arguments[1]:void 0)}},4160:function(e,t,o){"use strict";var l=o("23e7"),r=o("17c2");l({target:"Array",proto:!0,forced:[].forEach!=r},{forEach:r})},a15b:function(e,t,o){"use strict";var l=o("23e7"),r=o("44ad"),i=o("fc6a"),a=o("a640"),c=[].join,s=r!=Object,n=a("join",",");l({target:"Array",proto:!0,forced:s||!n},{join:function(e){return c.call(i(this),void 0===e?",":e)}})},c0f2:function(e,t,o){"use strict";o("0ead")},f50e:function(e,t,o){"use strict";o.r(t);var l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"roles"},[o("div",{staticClass:"header"},[o("Crumbs",{attrs:{breadcrumb:e.breadcrumb}})],1),o("div",{staticClass:"addRole"},[o("el-button",{staticStyle:{margin:"20px 0"},attrs:{type:"primary"},on:{click:function(t){e.addDialog=!0}}},[e._v("添加角色")])],1),o("div",{staticClass:"main"},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.roleLists.data,border:""}},[o("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left"}},e._l(t.row.children,(function(l){return o("el-row",{key:l.id,attrs:{gutter:24}},[o("el-col",{attrs:{span:3}},[o("div",{staticClass:"grid-content bg-purple"},[o("el-form-item",[o("div",{staticStyle:{display:"flex","align-items":"center"}},[o("el-tag",{attrs:{closable:""},on:{close:function(o){return e.closeRole(t.row,l.id)}}},[e._v(" "+e._s(l.authName)+" ")]),o("span",[e._v(">")])],1)])],1)]),o("el-col",{attrs:{span:21}},e._l(l.children,(function(l){return o("div",{key:l.id,staticClass:"grid-content bg-purple"},[o("el-form-item",[o("div",{staticStyle:{display:"flex","align-items":"center"}},[o("el-tag",{attrs:{closable:"",type:"success"},on:{close:function(o){return e.closeRole(t.row,l.id)}}},[e._v(" "+e._s(l.authName)+" ")]),o("span",[e._v(">")]),o("div",{staticStyle:{"margin-left":"80px",display:"flex"}},e._l(l.children,(function(l){return o("span",{key:l.id,staticStyle:{"padding-left":"10px"}},[o("el-tag",{attrs:{closable:"",type:"warning"},on:{close:function(o){return e.closeRole(t.row,l.id)}}},[e._v(" "+e._s(l.authName)+" ")])],1)})),0)],1)])],1)})),0)],1)})),1)]}}])}),o("el-table-column",{attrs:{type:"index",label:"#"}}),o("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),o("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),o("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(o){return e.compileOpen(t.row.id,t.row.roleName,t.row.roleDesc)}}}),o("el-button",{attrs:{slot:"reference",size:"small",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(o){return e.deleteRole(t.row.id)}},slot:"reference"}),o("el-button",{attrs:{size:"small",type:"success",icon:"el-icon-check",circle:""},on:{click:function(o){return e.AccreditOpen(t.row)}}})]}}])})],1)],1),o("el-dialog",{attrs:{title:"新增角色",visible:e.addDialog,width:"600px","destroy-on-close":""},on:{"update:visible":function(t){e.addDialog=t},close:e.closeRoleForm}},[o("el-form",{ref:"roleForm",staticClass:"demo-ruleForm",attrs:{model:e.roleForm,"label-width":"100px",rules:e.rules}},[o("el-form-item",{attrs:{label:"角色名",prop:"roleName"}},[o("el-input",{model:{value:e.roleForm.roleName,callback:function(t){e.$set(e.roleForm,"roleName",t)},expression:"roleForm.roleName"}})],1),o("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[o("el-input",{model:{value:e.roleForm.roleDesc,callback:function(t){e.$set(e.roleForm,"roleDesc",t)},expression:"roleForm.roleDesc"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addDialog=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addRole()}}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"编辑用户",visible:e.compileDialog,width:"600px"},on:{"update:visible":function(t){e.compileDialog=t}}},[o("el-form",{staticClass:"demo-ruleForm",attrs:{model:e.compileRole,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"角色ID",prop:"id"}},[o("el-input",{attrs:{disabled:""},model:{value:e.compileRole.id,callback:function(t){e.$set(e.compileRole,"id",t)},expression:"compileRole.id"}})],1),o("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[o("el-input",{model:{value:e.compileRole.roleName,callback:function(t){e.$set(e.compileRole,"roleName",t)},expression:"compileRole.roleName"}})],1),o("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[o("el-input",{model:{value:e.compileRole.roleDesc,callback:function(t){e.$set(e.compileRole,"roleDesc",t)},expression:"compileRole.roleDesc"}})],1)],1),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.compileDialog=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.compileRoles()}}},[e._v("确 定")])],1)],1),o("el-dialog",{attrs:{title:"角色授权",visible:e.accreditDialog,width:"600px"},on:{"update:visible":function(t){e.accreditDialog=t}}},[o("el-tree",{ref:"tree",attrs:{data:e.roleAccreditList.data,"show-checkbox":"","node-key":"id","default-checked-keys":e.checkedKeys,props:e.defaultProps,"default-expand-all":""}}),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.accreditDialog=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.roleAccredit()}}},[e._v("确 定")])],1)],1)],1)},r=[],i=(o("277d"),o("6b75"));function a(e){if(Array.isArray(e))return Object(i["a"])(e)}o("a4d3"),o("e01a"),o("d3b7"),o("d28b"),o("3ca3"),o("ddb0"),o("a630");function c(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=o("06c5");function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){return a(e)||c(e)||Object(s["a"])(e)||n()}var u=o("1da1"),f=(o("4160"),o("159b"),o("99af"),o("a15b"),o("a434"),o("96cf"),o("bcf2")),m=o("8f0c"),p={components:{Crumbs:f["a"]},data:function(){return{breadcrumb:[{title:"首页",name:"Home"},{title:"权限管理"},{title:"角色列表"}],addDialog:!1,roleForm:{roleName:"",roleDesc:""},rules:{roleName:[{required:!0,message:"请输入角色名",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"}]},roleLists:{},administration:{},compileRole:{id:"",roleName:"",roleDesc:""},compileDialog:!1,accreditDialog:!1,roleAccreditList:{},defaultProps:{children:"children",label:"authName"},checkedKeys:[],roleKeys:""}},methods:{roleList:function(){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$apis.roleList();case 2:o=t.sent,e.roleLists=o;case 4:case"end":return t.stop()}}),t)})))()},addRole:function(){var e=this;this.$refs.roleForm.validate().then((function(){e.$apis.addRole({roleName:e.roleForm.roleName,roleDesc:e.roleForm.roleDesc}).then((function(t){e.roleList()}))["catch"]((function(e){})),e.addDialog=!1,e.$refs.roleForm.resetFields()}))["catch"]((function(e){}))},closeRoleForm:function(){this.$refs.roleForm.resetFields()},compileOpen:function(e,t,o){this.compileDialog=!0,this.compileRole.id=e,this.compileRole.roleName=t,this.compileRole.roleDesc=o,this.compileId=e},compileRoles:function(){var e=this;this.$apis.compileRoles(this.compileRole.id,{id:this.compileRole.id,roleName:this.compileRole.roleName,roleDesc:this.compileRole.roleDesc}).then((function(t){e.compileDialog=!1,e.roleList()}))},deleteRole:function(e){var t=this;this.$confirm("此操作将永久删除数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$apis.deleteRole(e).then((function(e){t.roleList()}))}))["catch"]((function(){t.$message({type:"info",message:"已取消删除"})}))},AccreditOpen:function(e){var t=this;this.checkedKeys=[],this.getKeafKeys(e,this.checkedKeys),this.$apis.roleAccreditList().then((function(e){t.roleAccreditList=e,t.accreditDialog=!0})),this.roleKeys=e.id},getKeafKeys:function(e,t){var o=this;if(!e.children)return t.push(e.id);e.children.forEach((function(e){o.getKeafKeys(e,t)}))},roleAccredit:function(){var e=this,t=[].concat(d(this.$refs.tree.getCheckedKeys()),d(this.$refs.tree.getHalfCheckedKeys()));this.$apis.roleAccredit(this.roleKeys,{rids:t.join(",")}).then((function(t){e.roleList(),m["a"].$emit("event")})),this.accreditDialog=!1},closeRole:function(e,t){var o=this;this.$apis.closeRole(e.id,t).then((function(l){o.closes(e,t),m["a"].$emit("event")}))},closes:function(e,t){var o=this;e.children.forEach((function(l,r){l.id===t?e.children.splice(r,1):l.children&&o.closes(l,t)}))}},mounted:function(){this.roleList()}},h=p,b=(o("c0f2"),o("2877")),v=Object(b["a"])(h,l,r,!1,null,"4042a916",null);t["default"]=v.exports}}]);